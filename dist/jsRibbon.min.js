function enhanceForm({formId:t,targetId:e,method:n=null,swap:r="innerHTML",beforeSend:i=null,onSuccess:s=null,onError:o=null}){const a=document.getElementById(t),c=document.getElementById(e)||a.closest('[data-bind*="component:"]');a&&c?a.addEventListener("submit",async function(t){t.preventDefault(),"function"==typeof i&&i(a);const e=new FormData(a),l=n||a.method||"POST";try{const t=await fetch(a.action,{method:l.toUpperCase(),headers:{"X-Requested-With":"fetch"},body:e});let n;n=(t.headers.get("content-type")||"").includes("application/json")?await t.json():await t.text(),t.ok?"function"==typeof s?s(n):applySwap(c,n,r):"function"==typeof o?o(n,t.status):applySwap(c,`<strong>Error:</strong> ${t.status}`,r)}catch(t){"function"==typeof o?o(t.message,0):applySwap(c,`<strong>Network Error:</strong> ${t.message}`,r)}}):console.warn("Invalid formId or targetId passed.")}function applySwap(t,e,n){switch(console.log(t,e,n),n){case"outerHTML":t.outerHTML=e;break;case"append":t.insertAdjacentHTML("beforeend",e);break;case"prepend":t.insertAdjacentHTML("afterbegin",e);break;default:t.innerHTML=e}}!function(){function t(t){let e=[],n="",r=0;for(let i=0;i<t.length;i++){let s=t[i];"["===s?(r++,n+=s):"]"===s?(r--,n+=s):","===s&&0===r?(e.push(n.trim()),n=""):n+=s}return n.trim()&&e.push(n.trim()),e}function e(t){let e=t.indexOf(":");return-1===e?[t.trim(),null]:[t.slice(0,e).trim(),t.slice(e+1).trim()]}function n(n){let r=[],i=[];return n.forEach(n=>{let[s,o]=e(n);if("value"===s)r.push(o),i.push(s);else if("click"===s)o.includes(".")?r.push(o):r.push("cart."+o),i.push(s);else if("class"===s||"attr"===s){t(o.replace(/^\[|\]$/g,"").trim()).forEach(t=>{let[e,n]=t.split("=>").map(t=>t.trim());r.push(e),i.push(n)})}else if("foreach"===s){t(o.replace(/^\[|\]$/g,"").trim()).forEach(t=>{let[n,o]=e(t);"data"===n&&(r.push(o),i.push(s))})}}),{refs:r,names:i}}function r(t){return t.replace(/([a-z])([A-Z])/g,"$1 $2").split(/[\s_]+/).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}function i(t,e){const n=e.split(".");if(n.length>1){const i=r(n[0]),s=n[1];let o=t.parentElement;for(;o;){if(o.$state&&o.getAttribute("data-bind")?.includes(`component:${i}`))return{state:o.$state,subscribe:o.$subscribe,key:s};o=o.parentElement}throw new Error(`Context "${i}" not found for binding "${e}"`)}}function s(t){const e={};let n="",r=0;for(let i=0;i<t.length;i++){const s=t[i];","===s&&0===r?(o(n,e),n=""):("["!==s&&"{"!==s||r++,"]"!==s&&"}"!==s||r--,n+=s)}return n&&o(n,e),e}function o(t,e){const n=t.split(":");if(n.length>=2){const t=n[0].trim(),r=n.slice(1).join(":").trim();e[t]=r}}function a(t){return t.closest('[data-bind*="foreach:"]')||t.closest('[data-bind*="with:"]')}function c(t,e,n,r,o,a){if(o.includes(".")){const n=i(t,o);if(!n)return void console.warn("Could not resolve foreach data:",o);a=n.state;const r=n.key;e=a[r],o=r}t.innerHTML="",e.forEach((e,i)=>{const a=r.cloneNode(!0);a.setAttribute("data-key",i),a.setAttribute("data-foreach-owner",o);let c=[];a.hasAttribute("data-bind")&&c.push(a),c=c.concat(Array.from(a.querySelectorAll("[data-bind]"))),c.forEach(t=>{const r=s(t.getAttribute("data-bind"));for(let[i,s]of Object.entries(r)){let r;if(n&&s.startsWith(n+".")){const t=s.split(".").slice(1).join(".");r=e[t]}else r=e[s];"text"===i&&(t.textContent=r??""),"value"===i&&t instanceof HTMLInputElement&&(t.value=r??"","checkbox"===t.type&&(t.checked=!!r))}}),t.appendChild(a)})}function l(t,e,n,r){if(!t.foreach)return;let{arrayKey:o,alias:a}=function(t){let e=t.foreach,n=null;if(e.startsWith("["))try{e.trim().replace(/^\[|\]$/g,"").split(",").map(t=>t.trim()).forEach(t=>{const[r,i]=t.split(":").map(t=>t.trim());"data"===r&&(e=i),"as"===r&&(n=i)})}catch(t){return void console.warn("Invalid foreach syntax",e)}return{arrayKey:e,alias:n}}(t),{targetState:l,finalKey:u,originalKey:d}=function(t,e,n){let r=e,s=n,o=n;if(n.includes(".")){const e=i(t,n);if(!e)return void console.warn("Could not resolve foreach data:",n);r=e.state,s=e.key}return{targetState:r,finalKey:s,originalKey:o}}(e,n,o),{children:f,template:p}=function(t,e){let n=Array.from(t.children||[]),r=null;if(!(n&&n.length>0))throw new Error(`Markup not found for foreach binding "${e}"`);{let t=n[0];if("TEMPLATE"===t.tagName){const n=t.content.cloneNode(!0).firstElementChild;if(!n)throw new Error(`Empty <template> in foreach binding "${e}"`);r=n,r.setAttribute("data-template-origin",e),t.remove()}else r=t.cloneNode(!0)}return n=Array.from(t.children||[]).filter(t=>"TEMPLATE"!==t.tagName),{children:n,template:r}}(e,u),h=function(t,e){let n=Array.isArray(e)?e:null;n||(n=t.map(t=>{const e={};return t.querySelectorAll("[data-bind]").forEach(t=>{const n=s(t.getAttribute("data-bind"));for(let[r,i]of Object.entries(n))"text"===r&&(e[i]=t.textContent.trim()),"value"===r&&t instanceof HTMLInputElement&&(e[i]="checkbox"===t.type?t.checked:t.value)}),e}));return n}(f,l[u]);l[u]=function(t,e,n,r,i,s){return new Proxy(e,{get:(e,o,a)=>["push","splice","shift","unshift","pop","sort","reverse"].includes(o)?function(...a){const l=Array.prototype[o].apply(e,a);return c(t,s[i],n,r,i,s),l}:Reflect.get(e,o,a),set(e,o,a,l){const u=Reflect.set(e,o,a,l);return c(t,s[i],n,r,i,s),u}})}(e,h,a,p,u,l),r.push({el:e,type:"foreach",key:u,bindings:t,finalKey:u,alias:a,template:p,targetState:l,originalKey:d})}window.jsRibbonState={init:function(e,r={}){e.$ctx;const o=[],u={},d={},f=e.querySelectorAll("[data-bind]"),p=[];f.forEach(t=>{const n=t.closest('[data-bind*="component:"]');n===e?p.push(t):n||console.warn("‚ö†Ô∏è Found data-bind element outside any component:",t)}),p.forEach(t=>{const e=s(t.getAttribute("data-bind"));!function(t,e,n,r){let{text:i}=t;if(i&&(e.push({el:n,type:"text",key:i,bindings:t}),!(i in r))){const t=n.textContent.trim();t?a(n)||(r[i]=t):a(n)||(r[i]="")}}(e,o,t,u),function(t,e,n,r,i){let{value:s,update:o}=t;if(s)if(e.push({el:n,type:"value",key:s,updateEvent:o||null,bindings:t}),r[s]=(r[s]||0)+1,s in i)n.value&&n.value.trim()&&(a(n)||(i[s]=n.value));else{let t;if("checkbox"===n.type)t=r[s]>1?[]:!!n.checked;else if("radio"===n.type)n.checked&&(t=n.value);else if("number"===n.type){const e=parseFloat(n.value);t=isNaN(e)?"":e}else t=n.value;a(n)||(i[s]=t)}}(e,o,t,d,u),function(t,e,n,r){t.toggle&&(e.push({el:n,type:"toggle",key:t.all,updateEvent:t.update||null,bindings:t}),t.all in r||a(n)||(r[t.all]=[]))}(e,o,t,u),function(t,e,n,r){t.visible&&(e.push({el:n,type:"visible",key:t.visible,updateEvent:t.update||null,bindings:t}),t.visible in r||a(n)||(r[t.visible]=!0))}(e,o,t,u),function(t,e,n,r){t.html&&(e.push({el:n,type:"html",key:t.html,updateEvent:t.update||null,bindings:t}),t.html in r||a(n)||(r[t.html]=""))}(e,o,t,u),function(t,e,n,r){if(t.class)try{const i=t.class.trim().replace(/^\[|\]$/g,"").trim(),s=/([\w.]+)\s*=>\s*([\w-]+)/g;let o;for(;null!==(o=s.exec(i));){const t=o[1];t in e||a(n)||(e[t]=!1)}r.push({el:n,type:"class",key:t.class,updateEvent:t.update||null,bindings:t})}catch(e){console.warn("Invalid class binding during initialization:",t.class)}}(e,u,t,o),function(t,e,n,r){if(t.attr)try{const i=t.attr.trim().replace(/^\[|\]$/g,"").trim(),s=/([\w.]+)\s*=>\s*([\w-]+)/g;let o;for(;null!==(o=s.exec(i));){const t=o[1];t in e||a(n)||(e[t]="")}r.push({el:n,type:"attr",key:t.attr,updateEvent:t.update||null,bindings:t})}catch(e){console.warn("Invalid attr binding during initialization:",t.attr)}}(e,u,t,o),function(t,e,n){t.submit&&e.push({el:n,type:"submit",key:t.submit,bindings:t})}(e,o,t),l(e,t,u,o)});const{state:h,subscribe:b}=function(t){const e={};function n(t,n){return new Proxy(t,{get:(t,r,i)=>["push","splice","shift","unshift","pop","sort","reverse"].includes(r)?function(...i){const s=Array.prototype[r].apply(t,i);return e[n]&&e[n].forEach(e=>e(t)),s}:Reflect.get(t,r,i),set(t,r,i,s){const o=Reflect.set(t,r,i,s);return e[n]&&e[n].forEach(e=>e(t)),o}})}const r=new Proxy(t,{get:(t,e,n)=>Reflect.get(t,e,n),set(t,r,i,s){Array.isArray(i)&&(i=n(i,r));const o=Reflect.set(t,r,i,s);return e[r]&&e[r].forEach(t=>t(i)),o}});for(const e in t)Array.isArray(t[e])&&(r[e]=n(t[e],e));return{state:r,subscribe:function(t,n){e[t]||(e[t]=[]),e[t].push(n)}}}(u);e.$state=h,e.$subscribe=b,o.forEach(r=>{let{el:s,updateEvent:o,bindings:a}=r;Object.entries(a).forEach(([l,u])=>{!function(t,e,n,r,s){if("text"===n)e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.textContent=r[e],s(e,e=>{t.textContent=Array.isArray(e)?e.join(", "):e})}(s,u,l,h,b),function(t,e,n,r,s,o,a){if("value"===n&&t instanceof HTMLInputElement){e.split(".").length>1&&({state:r,subscribe:o,key:e}=i(t,e)||{state:r,subscribe:o,key:e});const n=t.type,c=s||("checkbox"===n||"radio"===n?"change":"input");if("checkbox"===n){const n=t.value;return void(Array.isArray(r[e])||a[e]>1?(Array.isArray(r[e])||(r[e]=[]),t.checked=r[e].includes(n),t.addEventListener(c,()=>{const i=new Set(r[e]);t.checked?i.add(n):i.delete(n),r[e]=[...i]}),o(e,e=>{t.checked=e.includes(n)})):(t.checked=!!r[e],t.addEventListener(c,()=>{r[e]=t.checked}),o(e,e=>{t.checked=!!e})))}if("radio"===n){const n=t.value;if(t.closest('[data-bind*="component:"]')){const n=t.closest('[data-bind*="component:"]'),r=`${t.getAttribute("name")||e}_${n.$id}`;t.setAttribute("name",r)}return!(e in r)&&t.checked&&(r[e]=n),t.checked=r[e]===n,t.addEventListener(c,()=>{t.checked&&(r[e]=n)}),void o(e,e=>{t.checked=e===n})}const l=t.hasAttribute("min")?parseFloat(t.getAttribute("min")):null,u=t.hasAttribute("max")?parseFloat(t.getAttribute("max")):null;t.value=r[e],t.addEventListener(c,t=>{let i=t.target.value;"number"===n&&(i=parseFloat(i),isNaN(i)?i="":(null!==l&&i<l&&(i=l),null!==u&&i>u&&(i=u))),r[e]=i}),o(e,e=>{t.value!==e&&(t.value=e)})}}(s,u,l,h,o,b,d),function(t,e,n,r,s,o){if("value"===n&&t instanceof HTMLSelectElement){e.split(".").length>1&&({state:r,subscribe:o,key:e}=i(t,e)||{state:r,subscribe:o,key:e});const n=s||"change",a=e=>{if(t.multiple){const n=Array.isArray(e)?e.map(String):[];for(const e of t.options)e.selected=n.includes(e.value)}else t.value=e??""};a(r[e]),t.addEventListener(n,()=>{if(t.multiple){const n=Array.from(t.selectedOptions,t=>t.value);r[e]=n}else r[e]=t.value}),o(e,t=>{a(t)})}}(s,u,l,h,o,b),function(t,e,n,r,s,o){if("value"===n&&t instanceof HTMLTextAreaElement){e.split(".").length>1&&({state:r,subscribe:o,key:e}=i(t,e)||{state:r,subscribe:o,key:e});const n=s||"input";t.value=r[e],t.addEventListener(n,t=>{r[e]=t.target.value}),o(e,e=>{t.value!==e&&(t.value=e)})}}(s,u,l,h,o,b),function(t,e,n,r,s){if("focused"===n)e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.addEventListener("focus",()=>{r[e]=!0}),t.addEventListener("blur",()=>{r[e]=!1}),s(e,e=>{e&&document.activeElement!==t&&t.focus()})}(s,u,l,h,b),function(t,e,n,r,s){if("visible"===n){e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e});const n=e=>{t.style.display=e?"":"none"};n(r[e]),s(e,t=>{n(t)})}}(s,u,l,h,b),function(t,e,n,r,s){"readonly"===n&&(e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.readOnly=!!r[e],s(e,e=>{t.readOnly=!!e}))}(s,u,l,h,b),function(t,e,n,r,s){"disabled"===n&&(e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.disabled=!!r[e],s(e,e=>{t.disabled=!!e}))}(s,u,l,h,b),function(t,e,n,r,s,o){"toggle"===n&&t instanceof HTMLInputElement&&"checkbox"===t.type&&(e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.addEventListener("change",()=>{const n=o.querySelectorAll(`input[type="checkbox"][data-bind*="value:${e}"]`),i=Array.from(n).map(t=>t.value);r[e]=t.checked?i:[]}),s(e,n=>{const r=o.querySelectorAll(`input[type="checkbox"][data-bind*="value:${e}"]`),i=Array.from(r).map(t=>t.value);t.checked=Array.isArray(n)&&i.every(t=>n.includes(t))}))}(s,u,l,h,b,e),function(t,e,n,r,s){if("html"===n)e.split(".").length>1&&({state:r,subscribe:s,key:e}=i(t,e)||{state:r,subscribe:s,key:e}),t.innerHTML=r[e],s(e,e=>{t.innerHTML=e})}(s,u,l,h,b),function(e,r,s,o,a){if("class"===s){if(r.split(".").length>1){let o=t(`${s}:${r}`),{refs:a,names:c}=n(o);a.forEach((t,n)=>{let s=i(e,t),{state:o,subscribe:a,key:l}=s,u=c[n];try{e.classList.toggle(u,!!o[l]),a(l,t=>{e.classList.toggle(u,!!t)})}catch(t){console.warn("Invalid class binding:",r)}})}try{const t=r.trim().replace(/^\[|\]$/g,"").trim().split(",").map(t=>t.trim());for(const n of t){const[t,r]=n.split(/\s*=>\s*/);t&&r&&(e.classList.toggle(r,!!o[t]),a(t,t=>{e.classList.toggle(r,!!t)}))}}catch(t){console.warn("Invalid class binding:",r)}}}(s,u,l,h,b),function(e,r,s,o,a){if("attr"===s){if(r.split(".").length>1){let s=t(`attr:${r}`),{refs:o,names:a}=n(s);return void o.forEach((t,n)=>{let s=i(e,t),{state:o,subscribe:c,key:l}=s;try{let t=a[n];e.setAttribute(t,o[l]??""),c(l,n=>{e.setAttribute(t,n??"")})}catch(t){console.warn("Invalid attr binding:",r)}})}try{const t=r.trim().replace(/^\[|\]$/g,"").trim().split(",").map(t=>t.trim());for(const n of t){const[t,r]=n.split(/\s*=>\s*/);t&&r&&(e.setAttribute(r,o[t]??""),a(t,t=>{e.setAttribute(r,t??"")}))}}catch(t){console.warn("Invalid attr binding:",r)}}}(s,u,l,h,b),function(t,e,n,r,s){if("submit"===n&&t instanceof HTMLFormElement){e.split(".").length>1&&({key:e}=i(t,e)||{key:e});const n=e.trim(),o=r.swap?.trim()||"innerHTML";if("ajax"===n){const e=t.id||`form-${Math.random().toString(36).slice(2)}`;t.id=e;const n=s,r=n.id||`target-${Math.random().toString(36).slice(2)}`;n.id=r;const i=s.$ctx||{};enhanceForm({formId:e,targetId:r,swap:o,beforeSend:i.beforeSend,onSuccess:i.onSuccess,onError:i.onError})}}}(s,u,l,a,e),function(t,e,n,r){if("foreach"!==e)return;let{alias:s,template:o,finalKey:a,originalKey:l,targetState:u}=r;if(l.includes(".")){const e=i(t,l);if(!e)return void console.warn("Could not resolve foreach data:",l);n=e.state,a=e.key}c(t,u[a],s,o,l,n)}(s,l,h,r)})})},parseBindings:s,resolveMethod:function(t,e){const n=e.split(".");if(1===n.length)return t.$ctx?.[n[0]];const i=r(n[0]),s=n[1];let o=t.parentElement;for(;o;){if(o.$state&&o.getAttribute("data-bind")?.includes(`component:${i}`))return o.$ctx[s];o=o.parentElement}},enhanceForm:enhanceForm,applySwap:applySwap}}(),function(){let t=new Map,e=new WeakSet,n=new Set,r=!0,i=!1;const s=new Map;function o(t){if(!t||"string"!=typeof t)return[];const e=[];let n="",r=0,i=null;for(let s=0;s<t.length;s++){const o=t[s];i?(n+=o,o===i&&"\\"!==t[s-1]&&(i=null)):'"'!==o&&"'"!==o?"["!==o&&"{"!==o&&"("!==o?"]"!==o&&"}"!==o&&")"!==o?","!==o||0!==r?n+=o:(n.trim()&&e.push(n.trim()),n=""):(r=Math.max(0,r-1),n+=o):(r++,n+=o):(i=o,n+=o)}return n.trim()&&e.push(n.trim()),e}function a(t){return(t||"").replace(/^\s*['"]?|['"]?\s*$/g,"").trim()}function c(t){const e=t.trim();if(!e)return null;if(/^\*$/i.test(e)||/^['"]\*['"]$/.test(e))return{kind:"wildcard"};const n=e.match(/^(.+?)\s+as\s+(.+)$/i);if(n)return{kind:"alias",source:a(n[1]),target:a(n[2])};const r=e.match(/^(.+?)\s*=>\s*(.+)$/);if(r)return{kind:"map",source:a(r[1]),target:a(r[2])};const i=e.match(/^(.+?)\s*:\s*(.+)$/);if(i)return{kind:"map",source:a(i[2]),target:a(i[1])};const s=a(e);return{kind:"plain",source:s,target:s}}function l(t){if(null==t)return{type:"raw",raw:""};const e=t.trim();return e?"["===e[0]&&"]"===e[e.length-1]?function(t){const e=t.replace(/^\s*\[|\]\s*$/g,"").trim();if(""===e)return{type:"list",items:[]};const n=o(e),r=[];let i=!1;for(const t of n){const e=c(t);e&&("wildcard"!==e.kind?r.push(e):i=!0)}return i?{type:"wildcard",items:r}:{type:"list",items:r}}(e):{type:"ident",name:a(e)}:{type:"raw",raw:""}}function u(t){const e={};if(!t||"string"!=typeof t)return e;const n=o(t);for(const t of n){let n=-1,r=0,i=null;for(let e=0;e<t.length;e++){const s=t[e];if(i)s===i&&"\\"!==t[e-1]&&(i=null);else if('"'!==s&&"'"!==s)if("["!==s&&"{"!==s&&"("!==s)if("]"!==s&&"}"!==s&&")"!==s){if(":"===s&&0===r){n=e;break}}else r=Math.max(0,r-1);else r++;else i=s}if(-1===n){e[t.trim()]={type:"literal",value:!0};continue}const s=t.slice(0,n).trim(),o=t.slice(n+1).trim();e[s]=l(o)}return e}function d(t){const e=t.getAttribute?.("data-bind")?.trim();return u(e||"")}function f(r){if(e.has(r))return;const i=d(r),o=i.component,a=r.getAttribute?.("data-key");if(!o)return;const{type:c,name:l}=o;if("ident"===c&&l){const t=r.innerHTML.replace(/\s+/g," ").replace(/>\s+</g,"><").trim();if(s.has(l)){if(s.get(l)!==t){const t=`‚ùå JS Ribbon Error: Component "${l}" detected with multiple markup structures.\n‚Üí Ensure backend uses consistent HTML for this component.\n‚ö†Ô∏è Offending element:`;if(window.jsRibbon.hardFail)throw new Error(t,{cause:r});console.warn(t,r)}}else s.set(l,t)}if("ident"!=c)return;if(a){const t=`${l}:${a}`;if(n.has(t))return void console.log(`‚ö†Ô∏è Duplicate component "${l}" with key "${a}" skipped.`,r);n.add(t)}if(i.parent){const t=function(t,e){let n=t.parentElement;for(;n;){const t=n.getAttribute?.("data-bind")?.trim();if(t){const n=t.match(/component\s*:\s*([\w-]+)/i);if(n&&n[1]===e)return!0}n=n.parentElement}return!1}(r,i.parent);t||console.warn(`‚ö†Ô∏è Component "${l}" is missing expected parent "${i.parent}".`,r)}t.has(l)||t.set(l,[]),t.get(l).push(r),e.add(r),window.jsRibbonState?.init&&window.jsRibbonState.init(r,r.$context);const u=window.jsRibbon.components?.[l];if("function"==typeof u)try{const t=u(r.$state,r)||{};if(r.$ctx=t,!r._delegatedEventsInstalled){r._delegatedEventsInstalled=!0;["click","dblclick","mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","keydown","keyup","keypress","input","change","focus","blur","contextmenu"].forEach(t=>{r.addEventListener(t,e=>{const n=e.target.closest("[data-bind]");if(!n||!r.contains(n))return;const i=window.jsRibbonState.parseBindings(n.getAttribute("data-bind")||"")[t];if(!i)return;if("click"===t&&"removeItem"===i){const t=n.closest("[data-key][data-foreach-owner]");if(!t)return;const e=parseInt(t.getAttribute("data-key"),10),i=t.getAttribute("data-foreach-owner"),s=r.$state[i];return void(Array.isArray(s)&&s.splice(e,1))}let s=r.$state;const o=n.closest("[data-key][data-foreach-owner]");if(o){const t=o.getAttribute("data-foreach-owner"),e=parseInt(o.getAttribute("data-key"),10),n=r.$state[t];Array.isArray(n)&&(s=n[e])}const a=i.includes(".")?n:r,c=window.jsRibbonState.resolveMethod(a,i);if("function"!=typeof c)return void console.warn(`‚ö†Ô∏è Event handler "${i}" not found in "${l}"`);const u=function(t){const e={};for(const[n,r]of Object.entries(t))if("true"===r)e[n]=!0;else if("false"===r)e[n]=!1;else if("null"===r)e[n]=null;else if(isNaN(r)||""===r.trim())if(/^{.*}$/.test(r)||/^\[.*\]$/.test(r))try{e[n]=JSON.parse(r)}catch{e[n]=r}else e[n]=r;else e[n]=+r;return e}(n.dataset||{}),d={...u};delete d.bind;try{c.call(s,e,d,n)}catch(t){console.error(`Error executing handler "${i}":`,t)}})})}}catch(t){console.warn(`‚ö†Ô∏è Failed to initialize component "${l}"`,t),r.$ctx={}}}function p(r){if(!e.has(r))return;const i=d(r).component,s=r.getAttribute?.("data-key");if(!i)return;const o=t.get(i);if(o){const e=o.indexOf(r);-1!==e&&(o.splice(e,1),console.log(`üóëÔ∏è Component removed: ${i}`,r)),0===o.length&&t.delete(i)}if(s){const t=`${i}:${s}`;n.delete(t)}e.delete(r)}function h(t){if(1!==t.nodeType&&9!==t.nodeType)return;t.hasAttribute?.("data-bind")&&f(t);(t.querySelectorAll?.("[data-bind]")||[]).forEach(t=>f(t))}function b(t){if(1!==t.nodeType&&9!==t.nodeType)return;t.hasAttribute?.("data-bind")&&p(t);(t.querySelectorAll?.("[data-bind]")||[]).forEach(t=>p(t))}document.addEventListener("DOMContentLoaded",()=>{h(document),new MutationObserver(t=>{if(r)for(const e of t)for(const t of e.addedNodes)h(t);for(const e of t)for(const t of e.removedNodes)b(t)}).observe(document.body,{childList:!0,subtree:!0}),console.log("üîß Component system initialized with autoRegister = "+r)}),window.jsRibbon={getComponents:()=>t,getInstances:e=>t.get(e)||[],get autoRegister(){return r},set autoRegister(t){r=!!t,console.log(`üîÅ autoRegister is now ${r}`)},get hardFail(){return i},set hardFail(t){i=!!t,console.log(`üîÅ hardFail is now ${i}`)},unregister(t){p(t)},scanAndRegister:h,scanAndUnregister:b,reset(){t.clear(),n.clear(),s.clear(),e=new WeakSet,console.log("‚ôªÔ∏è Component system has been reset."),h(document)},components:{},component(t,e){this.components[t]=e}}}();